<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Planificateur Jeunesse Pro - Organisez vos activités et projets" />
    <meta name="theme-color" content="#0f172a" />
    <title>Planificateur Jeunesse Pro</title>
    
    <!-- Preconnect pour optimiser le chargement des fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Google Fonts optimisées -->
    <link 
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@300;400;500;700&family=Permanent+Marker&display=swap" 
      rel="stylesheet"
      crossorigin="anonymous"
    />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              mdj: {
                cyan: '#00FFFF',
                orange: '#FF7A59',
                yellow: '#FFFF00',
                magenta: '#FF00FF',
                red: '#ef4444',
                black: '#0f172a',
                dark: '#1e293b',
                surface: '#334155'
              }
            },
            fontFamily: {
              sans: ['Montserrat', 'sans-serif'],
              display: ['Space Grotesk', 'sans-serif'],
              funky: ['Permanent Marker', 'cursive'],
            },
            animation: {
              'fade-in': 'fadeIn 0.5s ease-in-out',
              'slide-up': 'slideUp 0.4s ease-out',
              'bounce-soft': 'bounceSoft 2s infinite',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' }
              },
              slideUp: {
                '0%': { transform: 'translateY(20px)', opacity: '0' },
                '100%': { transform: 'translateY(0)', opacity: '1' }
              },
              bounceSoft: {
                '0%, 100%': { transform: 'translateY(0)' },
                '50%': { transform: 'translateY(-10px)' }
              }
            }
          }
        }
      }
    </script>

    <style>
      /* Base Styles */
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        color: #f8fafc;
        font-family: 'Montserrat', sans-serif;
        min-height: 100vh;
        overflow-x: hidden;
      }
      ::-webkit-scrollbar { width: 12px; height: 12px; }
      ::-webkit-scrollbar-track { background: #0f172a; }
      ::-webkit-scrollbar-thumb { background: linear-gradient(180deg, #334155 0%, #475569 100%); border-radius: 6px; border: 2px solid #0f172a; }
      ::-webkit-scrollbar-thumb:hover { background: linear-gradient(180deg, #FF7A59 0%, #ef4444 100%); }
      * { scrollbar-width: thin; scrollbar-color: #334155 #0f172a; }
      .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
      .glass-strong { background: rgba(30, 41, 59, 0.9); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); }
      .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: #00FFFF; animation: spin 0.8s linear infinite; }
      @keyframes spin { to { transform: rotate(360deg); } }
      .gradient-text { background: linear-gradient(135deg, #00FFFF 0%, #FF7A59 50%, #FFFF00 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
      .neon-glow { box-shadow: 0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), 0 0 60px rgba(0, 255, 255, 0.1); }
      .neon-glow-orange { box-shadow: 0 0 20px rgba(255, 122, 89, 0.5), 0 0 40px rgba(255, 122, 89, 0.3); }
      ::selection { background: rgba(0, 255, 255, 0.3); color: #fff; }
      button:focus-visible, input:focus-visible, textarea:focus-visible { outline: 2px solid #00FFFF; outline-offset: 2px; }
      button, input, textarea, select { transition: all 0.2s ease-in-out; }
      #root { min-height: 100vh; width: 100%; }
      .error-boundary { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 2rem; text-align: center; }
      .error-boundary h1 { font-size: 3rem; margin-bottom: 1rem; color: #ef4444; }
      .error-boundary p { font-size: 1.125rem; color: #94a3b8; margin-bottom: 2rem; max-width: 600px; }
      .loading-screen { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; transition: opacity 0.5s ease-out; }
      .loading-screen .spinner-large { width: 60px; height: 60px; border: 4px solid rgba(255, 255, 255, 0.1); border-radius: 50%; border-top-color: #00FFFF; animation: spin 1s linear infinite; }
      @media print { body { background: white; color: black; } .no-print { display: none !important; } }
      @media (prefers-reduced-motion: reduce) { *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; } }
    </style>

    <!-- Import Map CORRIGÉ avec gstatic.com pour éviter les conflits -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom": "https://esm.sh/react-dom@18.2.0?deps=react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?deps=react@18.2.0",
        "lucide-react": "https://esm.sh/lucide-react@0.344.0?deps=react@18.2.0",
        "recharts": "https://esm.sh/recharts@2.12.0?deps=react@18.2.0,react-dom@18.2.0",
        "pdfjs-dist": "https://esm.sh/pdfjs-dist@4.0.379",
        "mammoth": "https://esm.sh/mammoth@1.7.1",
        "react-dom/": "https://esm.sh/react-dom@^18.2.0/",
        "react/": "https://esm.sh/react@^18.2.0/",
        "@google/genai": "https://esm.sh/@google/genai",
        "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js",
        "firebase/analytics": "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js",
        "firebase/": "https://www.gstatic.com/firebasejs/10.8.0/",
        "@azure/msal-browser": "https://esm.sh/@azure/msal-browser@^5.1.0",
        "@microsoft/microsoft-graph-client": "https://esm.sh/@microsoft/microsoft-graph-client@^3.0.7"
      }
    }
    </script>
  </head>
  
  <body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
      <div class="spinner-large" id="loading-spinner"></div>
      <p id="loading-text" style="margin-top: 2rem; font-size: 1.25rem; color: #94a3b8;">
        Initialisation du système...
      </p>
    </div>

    <!-- Main App Container -->
    <div id="root"></div>

    <!-- Error Fallback -->
    <noscript>
      <div class="error-boundary">
        <h1>⚠️</h1>
        <p>JavaScript doit être activé pour utiliser cette application.</p>
      </div>
    </noscript>

    <!-- Main Application Script -->
    <script type="module">
        import '/index.tsx';
    </script>
  </body>
</html>